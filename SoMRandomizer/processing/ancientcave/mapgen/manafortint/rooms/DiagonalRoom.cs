using System;

namespace SoMRandomizer.processing.ancientcave.mapgen.manafortint.rooms
{
    /// <summary>
    /// Diagonally shaped manafort tileset room.
    /// </summary>
    /// 
    /// <remarks>Author: Moppleton</remarks>
    public class DiagonalRoom : ManafortRoomMaker
    {
        static byte[] baseRoom = new byte[] {
                107, 107, 135, 174, 174,  80, 174, 174,  80, 174, 174, 136, 107, 107, 107, 107, 107, 107, 107, 107,
                 77,  77, 159, 147, 147,  96, 147, 147,  96, 147, 147, 157,  77,  77,  77,  77,  77,  77,  77,  77,
                 76, 135,  99, 114, 116, 112, 114, 116, 112, 114, 116,  98, 174, 174, 174, 174, 174,  80, 136, 108,
                 76, 159,  96, 130, 132, 128, 130, 132, 128, 130, 132,  96, 147, 147, 147, 147, 147,  96, 157, 106,
                 76, 159, 112, 146, 146, 144, 146, 146, 144, 146, 146, 112, 114, 116, 114, 116, 114, 112, 157,  95,
                 76, 159, 129,  12,  10, 161,  43,  43, 162,  12,  10, 128, 130, 132, 130, 132, 130, 128, 157,  76,
                 76, 159, 145,  10,  43,  43,  44,  42,  42,  43,  12, 144, 146, 146, 146, 146, 146, 144, 157,  76,
                 76, 159, 161,  43,  43,  44,  35,  35,  42,  43,  43, 160,  43,  43,  43,  43,  43, 162, 157,  76,
                 76, 159,  26,  43,  44,  35,  15,  15,  35,  42,  43,  43,  44,  28,  28,  12,  10,  28, 157,  76,
                 76, 159,  26,  11,  12,  15,  15,  15,  15,  35,  42,  43,  43,  44,  28,  28,  12,  28, 157,  76,
                 76, 159,  26,  11,  11,  12,  15,  15,  15,  15,  35,  42,  43,  43,  44,  28,  28,  28, 157,  76,
                 76, 159,  26,  10,  11,  11,  12,  15,  15,  15,  15,  35,  42,  43,  43,  44,  28,  28, 157,  76,
                 76, 159,  26,  26,  10,  11,  11,  12,  15,  15,  15,  15,  35,  42,  43,  43,  44,  28, 157,  76,
                 76, 159,  26,  26,  26,  10,  11,  11,  12,  15,  15,  15,  15,  35,  42,  43,  43,  28, 157,  76,
                 76, 159,  26,  42,  26,  26,  10,  11,  11,  12,  15,  15,  15,  15,  35,  42,  43,  28, 157,  76,
                 76, 159,  26,  35,  42,  26,  26,  10,  11,  11,  12,  15,  15,  15,  15,  35,  42,  28, 157,  76,
                 76, 159,  26,  15,  35,  42,  26,  26,  10,  11,  11,  12,  15,  15,  15,  15,  35,  28, 157,  76,
                 76, 159,  42,  43,  43,  43,  43,  43,  44,  11,  11,  42,  12,  15,  15,  15,  15,  35, 157,  76,
                 76, 151, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 142, 152,  76,
                106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106, 106,
            };

        // 0, 3
        static byte[] leftPassage = new byte[]
        {
                174,  99,
                147,  96,
                114, 112,
                130, 129,
                146, 145,
                 43, 161,
                 35,  35,
                 10,  44,
                 10,  12,
                 10,  44,
                 10,  12,
                 10,  44,
                 10,  12,
                 10,  44,
                142, 143,
        };

        // 18, 3
        static byte[] rightPassage = new byte[]
        {
                 98, 174,
                 96, 147,
                112, 114,
                128, 130,
                144, 146,
                160,  43,
                 35,  35,
                 10,  12,
                 10,  44,
                 10,  12,
                 10,  44,
                 10,  12,
                 10,  44,
                 10,  12,
                141, 142,
        };

        // 8, 17
        static byte[] bottomPassage = new byte[]
        {
                44, 5, 6, 42,
                140, 21, 22, 138,
                151, 139, 139, 152,
        };

        // 9, 0
        static byte[] topPassage = new byte[]
        {
                 171, 171,
                 147, 147,
                 46, 47,
                 53, 34,
                 69, 34,
        };

        // 9, 2 on top of topPassage
        static byte[] doorBlock = new byte[]
        {
                163, 164,
                176, 180,
                177, 181, // these two are the trigger tiles
        };

        public override byte[,] generateRoom(bool rightPath, bool leftPath, bool topPath, bool bottomPath, bool door, Random r)
        {
            byte[] room = new byte[400];
            for (int i = 0; i < 400; i++)
            {
                room[i] = baseRoom[i];
            }

            if (rightPath)
            {
                injectData(room, rightPassage, 18, 3, 2);
            }
            if (leftPath)
            {
                injectData(room, leftPassage, 0, 3, 2);
            }
            if (bottomPath)
            {
                injectData(room, bottomPassage, 8, 17, 4);
            }
            if (topPath)
            {
                injectData(room, topPassage, 9, 0, 2);
            }
            else if (door)
            {
                injectData(room, topPassage, 9, 0, 2);
                injectData(room, doorBlock, 9, 2, 2);
            }

            byte[,] layer1 = new byte[20, 20];

            for (int yPos = 0; yPos < 20; yPos++)
            {
                for (int xPos = 0; xPos < 20; xPos++)
                {
                    layer1[xPos, yPos] = room[yPos * 20 + xPos];
                }
            }

            return layer1;
        }
    }
}
